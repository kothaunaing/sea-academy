import{j as e,K as Q,r as a,A as X,a as _,c as ee,b as y,aZ as se,J as I,E as o,G as r,F as T,d as k,aN as te,M as ae,V as ie,aT as re,Y as oe,aF as ne,aV as ce,aI as le,aA as de,aC as me,aD as ue,az as L,aB as pe}from"./index-bR4MaZOJ.js";import{i as he}from"./browser-image-compression-9kymdGFS.js";import{c as xe}from"./createSvgIcon-3G1Z23-M.js";import{p as fe}from"./prettyDate-uNOGf4QX.js";import{f as ge}from"./fixTime-t8Fgsaat.js";import{S as n}from"./Skeleton-LRfmB9RD.js";import{a as je,F as B}from"./FavoriteBorder-gZEnJaMG.js";import{S as be}from"./Stack-WYlN-LHL.js";import{I as F}from"./IconButton-zFeYIEAO.js";import{C as $}from"./ContentCopySharp-0frtFtlg.js";import{T as ve}from"./TextField-lZjHCUEq.js";import{T as we}from"./Tooltip-jKN6Sqwz.js";import{E as ye}from"./EditSharp-tls7Gpwf.js";import"./Portal-vj8E7tuN.js";import"./Modal-AMyV4m0Z.js";import"./debounce-gOEKrWSg.js";import"./useControlled-Tg6WpoLH.js";const Ie=xe(e.jsx("path",{d:"M15 1H9v2h6zm-4 13h2V8h-2zm8.03-6.61 1.42-1.42c-.43-.51-.9-.99-1.41-1.41l-1.42 1.42C16.07 4.74 14.12 4 12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9 9-4.03 9-9c0-2.12-.74-4.07-1.97-5.61M12 20c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7"}),"TimerSharp"),qe=Q.memo(()=>{const{userData:m,users:ke,setHeaderTitle:S,openSnackbar:l}=a.useContext(X),[s,R]=a.useState(null),[U,C]=a.useState(!1),[p,x]=a.useState(!1),[f,D]=a.useState(null),[h,A]=a.useState(null),{userId:d}=_(),g=ee(k,`users/${d}/likes`),N=y(k,`/users/${d}`),[j,M]=a.useState(!1),[b,E]=a.useState(""),[z,P]=a.useState("offline"),[W,q]=a.useState(null);se(s==null?void 0:s.uid,P,q,[d,s]);const H=()=>te(N,i=>{i.exists()?(R({uid:i.id,...i.data()}),C(!1)):C(!0)});a.useEffect(()=>{const t=H();return()=>{t&&t()}},[d]);const c=()=>s&&m?m.uid===s.uid:!1,v=async()=>{await ae(g,D)};a.useEffect(()=>{const t=I.get("userId");(async()=>{const u=ie(g,re("uid","==",t)),w=await oe(u);x(!w.empty)})(),v()},[]);const V=async()=>{try{const t=I.get("userId"),i=y(g,m==null?void 0:m.uid),u={uid:t,timestamp:ne()};p?(x(!1),await le(i),v()):(x(!0),await ce(i,u),v())}catch(t){console.log(t.message)}};a.useEffect(()=>{s&&(c()?S("My Profile"):S(`${s.name}'s Profile`))},[s,d]);const J=async()=>{const t=I.get("userId"),i=y(k,`users/${t}`);if(!h)return;const u=`profile/${t}/${h.name}`,w=de(pe,u);l("Compressing image...");const K=await he(h,{maxSizeMB:.5,maxWidthOrHeight:1280,useWebWorker:!0});l("Uploading image...");const Y=await me(w,K),Z=await ue(Y.ref);await L(i,{coverImage:Z}),l("Changed cover image successfully")},O=()=>{document.getElementById("imageInput").click()};a.useEffect(()=>{J()},[h]),a.useEffect(()=>{E(s==null?void 0:s.bio)},[s]);const G=async()=>{await L(N,{bio:b}),l("Edited bio successfully")};return U?e.jsx(o,{m:2,children:"User not available!"}):e.jsxs(o,{children:[e.jsx("input",{id:"imageInput",className:"hidden",type:"file",accept:"image/*",onChange:t=>A(t.target.files[0])}),e.jsxs(o,{className:"relative ",children:[s?e.jsx("img",{onClick:()=>{c()&&O()},className:`w-full h-[150px] object-cover ${c()?"cursor-pointer hover:opacity-80":""}`,src:s!=null&&s.coverImage?s==null?void 0:s.coverImage:"/images/education.jpg"}):e.jsx(n,{sx:{mt:-5},height:200,width:"100%"}),s?e.jsx("div",{className:"absolute -bottom-[40%] left-[10%]",children:e.jsxs("div",{className:"relative",children:[e.jsx("img",{alt:s.name,className:"rounded-full  size-24 object-cover border ",src:s.image}),e.jsx("div",{className:"size-[20px] bg-white rounded-full flex justify-center items-center absolute bottom-0 right-2",children:e.jsx("div",{className:` size-4 rounded-full ${z==="online"?"bg-green-500":"bg-gray-500"}`})})]})}):e.jsx("div",{className:"absolute z-10 bottom-0 left-[10%]",children:e.jsx(n,{variant:"circular",height:"96px",width:"96px"})})]}),e.jsxs(o,{m:2,mt:8,className:"",children:[s?e.jsxs(e.Fragment,{children:[e.jsxs(o,{className:"flex gap-x-3",children:[e.jsx(r,{variant:"h5",children:s.name}),e.jsx(T,{onClick:V,color:"error",size:"small",sx:{textTransform:"capitalize"},variant:p?"contained":"outlined",startIcon:p?e.jsx(B,{}):e.jsx(je,{}),children:p?"Liked":"Like"})]}),e.jsx(r,{sx:{mb:1,mt:-1},children:z==="online"?e.jsx(r,{variant:"caption",sx:{color:"green"},children:"Online"}):e.jsx(r,{variant:"caption",sx:{color:"gray"},children:W})}),c()&&e.jsx(be,{children:e.jsx(r,{variant:"caption",children:s.email})}),e.jsxs(o,{className:"flex gap-x-2 items-center mt-1",children:[e.jsxs(r,{variant:"caption",children:["UID: ",s.uid]}),e.jsx("div",{children:e.jsx(F,{onClick:()=>{navigator.clipboard.writeText(s.uid),l("UID copied successfully")},size:"small",children:e.jsx($,{fontSize:"18px"})})})]})]}):e.jsx(n,{sx:{marginTop:"-50px"},height:35,width:150}),s?e.jsxs("div",{className:"flex mt-2 mb-2 gap-x-2 items-center  border border-dashed rounded-md shadow-md border-slate-400 p-2 justify-between",children:[j?e.jsx(ve,{fullWidth:!0,name:"bio",size:"small",variant:"outlined",multiline:!0,maxRows:5,autoFocus:!0,value:b,onChange:t=>E(t.target.value),className:"pl-1 pr-1 w-auto font-bold text-sm",placeholder:"Enter description",inputProps:{sx:{fontSize:12}}}):e.jsx(e.Fragment,{children:s?e.jsx(r,{sx:{whiteSpace:"pre-line",width:"90%"},variant:"caption",className:"font-bold",children:s!=null&&s.bio?s.bio:c()?"Bio: I am a student":"No bio"}):e.jsx(n,{height:40,width:150})}),s&&c()?e.jsx(we,{title:"Edit bio",arrow:!0,children:e.jsx(F,{size:"small",onClick:()=>{M(!j),j&&b!==s.bio&&G()},className:" p-1  cursor-pointer",children:e.jsx(ye,{sx:{width:20,height:20}})})}):e.jsx(e.Fragment,{children:c()&&e.jsx(n,{variant:"circular",height:20,width:20})})]}):e.jsx(n,{height:40,width:250})]}),e.jsx(o,{m:2,className:"",children:s?e.jsxs(o,{className:"grid gap-y-2",children:[e.jsxs(r,{variant:"caption",children:[e.jsx(Ie,{})," Joined: ",fe(ge(s.createdAt))]}),f?e.jsxs(r,{variant:"caption",children:[e.jsx(B,{color:"error"})," ",f," ",f<=1?"person":"people"]}):"",e.jsx("div",{className:"flex justify-start mt-2",children:e.jsx(T,{onClick:()=>{const t=`${location.origin}/#/app/profile/${d}`;navigator.clipboard.writeText(t),l(`Copied ${s==null?void 0:s.name}'s profile link successfully!`)},startIcon:e.jsx($,{}),size:"small",children:"Copy link"})})]}):e.jsxs(e.Fragment,{children:[e.jsx(n,{height:35,width:150}),e.jsx(n,{height:35,width:150})]})})]})});export{qe as default};
