import{r as i,A as b,u as z,X as Y,j as e,E as B,H as m,F as t,Y as F,Z as G,d as C,b as I,e as S,$ as p,a0 as H,a1 as O}from"./index-dSD7UM6z.js";import{g as E}from"./getImage-SzyEh5nT.js";import{L as D}from"./LoadingScreen-BgP5KCQC.js";import{S as $}from"./Stack-4mDqqL4m.js";import{T as x}from"./Typography-GbCp5BvV.js";import{B as n}from"./Button-ZTLNkO5Z.js";import{T as d}from"./TextField-tugteksq.js";import"./ButtonBase-D-lMm-wW.js";import"./Portal-nV2JPNiI.js";import"./Modal-40Myj6Vm.js";import"./debounce-gOEKrWSg.js";import"./useControlled-ajujHaEs.js";import"./createSvgIcon-5tUNT3Hd.js";const te=()=>{const{setHeaderTitle:h,setUserId:o,openSnackbar:r}=i.useContext(b),[v,L]=i.useState(""),[l,j]=i.useState(""),[c,y]=i.useState(""),[T,f]=i.useState("login"),U=z();i.useEffect(()=>{h("STAR EDUCATION ACADEMY")},[]);const u=()=>{U("/app")};Y("auto");const k=async()=>{try{r("Signing in with Google...");const a=(await G(t,F)).user,g=I(C,"users",a.uid);(await S(g)).exists()||await p(t.currentUser.displayName,t.currentUser.email,"",t.currentUser.photoURL,a.uid),m.set("userId",a.uid,{expires:365}),o(a.uid),u(),r(`Signed in as ${a.displayName} successfully`)}catch(s){r(s.message)}},A=async()=>{try{r("Logging in...");const a=(await H(t,l,c)).user,g=I(C,"users",a.uid);(await S(g)).exists()||await p(a.displayName,a.email,"","",a.uid),m.set("userId",a.uid,{expires:365}),o(a.uid),u(),r("Logged in successfully")}catch(s){r(s.message)}},P=async()=>{try{r("Creating an account...");const s=await O(t,l,c),{user:a}=s;m.set("userId",a.uid,{expires:365}),await p(v,l,c,"",a.uid),o(a.uid),u(),r("Created an account successfully")}catch(s){r(s.message)}},w=()=>{const s=m.get("userId")||null;let a=!1;return s&&(a=!0),{loggedIn:a,userId:s}},R=()=>{switch(T){case"login":return e.jsx("div",{children:e.jsxs("div",{className:"mt-10 flex flex-col items-center ",children:[e.jsx(x,{variant:"h6",color:"primary",children:"Log In"}),e.jsxs("div",{className:"grid p-2 w-5/6 sm:w-3/5 lg:w-4/6 gap-y-2",children:[e.jsx(d,{name:"email",variant:"filled",color:"primary",label:"Enter your email",type:"email",size:"small",value:l,onChange:s=>j(s.target.value)}),e.jsx(d,{name:"email",variant:"filled",color:"primary",label:"Enter your password",type:"password",size:"small",value:c,onChange:s=>y(s.target.value)}),e.jsx(n,{onClick:A,sx:{textTransform:"capitalize"},variant:"contained",color:"primary",children:"Log In"})]}),e.jsx(N,{}),e.jsx("div",{children:e.jsx(n,{onClick:k,startIcon:e.jsx("img",{className:"size-7",src:E("google")}),sx:{textTransform:"capitalize"},variant:"outlined",children:"Sign in With Google"})}),e.jsx(N,{}),e.jsx("div",{children:e.jsx(n,{onClick:()=>f("signup"),sx:{textTransform:"capitalize"},variant:"outlined",children:"Create new Account"})})]})});case"signup":return e.jsx("div",{children:e.jsxs("div",{className:"mt-10 flex flex-col items-center ",children:[e.jsx(x,{variant:"h6",color:"primary",children:"Create a new account"}),e.jsxs("div",{className:"grid p-2 w-5/6 sm:w-3/5 lg:w-4/6 gap-y-2",children:[e.jsx(d,{variant:"filled",color:"primary",label:"Enter your name",type:"email",size:"small",value:v,onChange:s=>L(s.target.value)}),e.jsx(d,{name:"email",variant:"filled",color:"primary",label:"Enter your email",type:"email",size:"small",value:l,onChange:s=>j(s.target.value)}),e.jsx(d,{name:"email",variant:"filled",color:"primary",label:"Enter your password",type:"password",size:"small",value:c,onChange:s=>y(s.target.value)}),e.jsx(n,{onClick:()=>{P()},sx:{textTransform:"capitalize"},variant:"contained",color:"primary",children:"Sign up"}),e.jsx("div",{children:e.jsx(n,{startIcon:e.jsx("img",{className:"size-7",src:E("back")}),onClick:()=>f("login"),sx:{textTransform:"capitalize"},variant:"outlined",color:"primary",children:"Log in"})})]})]})})}};return e.jsxs("div",{className:"Login mb-5",children:[e.jsx(D,{}),w().loggedIn?e.jsx(M,{userId:w().userId}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-md rounded-md font-medium  p-1 pl-2 border-b",children:"You must log in first."}),R()]})]})},N=()=>e.jsx("div",{className:"mt-2 mb-2 ",children:"OR"}),M=({userId:h})=>{const o=z(),{userData:r}=i.useContext(b);return e.jsxs($,{m:2,children:[e.jsxs(x,{children:["You are already logged in as ",r==null?void 0:r.name,"."]}),e.jsx(B,{mt:1,children:e.jsx(n,{onClick:()=>o("/app/settings"),variant:"outlined",children:"Settings"})})]})};export{te as default};
