import{I as P,r,A as I,h as D,u as T,j as e,aG as R,E as m,c as $,O as B,d as U,S as b,U as V,aJ as z,V as F,W as O,f as G}from"./index-14pqm9y1.js";import{s as H}from"./sortByDateNewer-X-Bb2bKS.js";import{L as q}from"./LoadingScreen-EYXdXKre.js";import{I as J}from"./ImageViewer-9eL0WPff.js";import{p as Q}from"./prettyDate-uNOGf4QX.js";import{f as W}from"./fixTime-t8Fgsaat.js";import{I as Y,F as K,L as X}from"./Links-_VS89QM1.js";import{R as Z}from"./Reactions-FlB2PVA1.js";import{S as _}from"./SkeletonPost-0a5nIlkW.js";import{M as ee}from"./MoreOption-CBEm1e9N.js";import{E as se}from"./EditSharp-Qr3GQduu.js";import{T as N}from"./Tooltip-cTALVPIn.js";import{T as k}from"./Typography-F2i8tb5R.js";import{L as te}from"./LinkSharp-V12iGhFD.js";import{G as re}from"./Grid-h-ZCuhow.js";import{M as v}from"./EmptyComponent-LbBV4xaA.js";import{F as oe}from"./FabSearch-egk5RJGK.js";import{B as ie}from"./Button-dux8T5OH.js";import"./Dialog-7UnCDBMC.js";import"./Modal-XJP-E1k3.js";import"./Portal-YB56xSUH.js";import"./Stack-bBqHnaWs.js";import"./IconButton-x0ar69Y7.js";import"./ButtonBase-ryrwXNwG.js";import"./CloseSharp-6-Zx-Mf5.js";import"./createSvgIcon-BoAk_7pD.js";import"./notify-fX9PdEbD.js";import"./FavoriteBorder-zXnu4wal.js";import"./Skeleton-aRLWJJ7b.js";import"./OtherActions-na3csAt4.js";import"./getImage-SzyEh5nT.js";import"./useControlled-qBYEK2eV.js";import"./Fab-Y1qd__Pp.js";import"./SearchSharp-j_EjSxko.js";const ae=P.memo(({post:s,setViewingImage:d})=>{var l,c;const{users:f,openSnackbar:x,userData:a}=r.useContext(I),[t,g]=r.useState(null),[h,u]=r.useState(!0);D().palette;const n=T(),j=a!=null&&a.isAdmin?{text:"Edit Post",icon:e.jsx(se,{}),onClick:()=>{n("/app/admin/posts/")}}:null;return R(s.uid,f,g,u,[],1200),h?e.jsx(_,{}):e.jsxs(m,{bgcolor:"background.default",color:"text.primary",className:"border border-slate-300 shadow-lg rounded-md",sx:{width:"full"},children:[e.jsxs(m,{className:"top-section flex justify-between  mb-2 p-2",children:[e.jsxs(m,{className:"flex gap-x-2",children:[e.jsx(N,{title:`View ${t&&t.name}'s profile`,arrow:!0,placement:"top",children:e.jsx("div",{className:"cursor-pointer",onClick:()=>n(`/app/profile/${t.uid}`),children:e.jsx("img",{className:"size-10 rounded-full shadow-md object-cover cursor-pointer",src:t?t.image:"images/sea-logo.jpg"})})}),e.jsxs(m,{children:[e.jsx(N,{title:`View ${t&&t.name}'s profile`,arrow:!0,placement:"top",children:e.jsx(k,{onClick:()=>n(`/app/profile/${t.uid}`),variant:"h6",fontSize:"1rem",sx:{cursor:"pointer"},children:t?t.name:"Unknown User"})}),e.jsx(k,{variant:"caption",children:Q(W(s.time))})]})]}),e.jsx(m,{children:e.jsx(ee,{options:[{text:"Copy link",icon:e.jsx(te,{}),onClick:()=>{const S=`${location.origin}/#/app/posts/sp/${s.id}`;navigator.clipboard.writeText(S),x("Link copied successfully")}},j],isComment:!0})})]}),(s==null?void 0:s.description)&&e.jsx(k,{p:1,children:s.description}),s.images.length!==0?e.jsx(re,{container:!0,spacing:1,className:" p-0",sx:{p:1},children:e.jsx(Y,{post:s,setViewingImage:d})}):"",s.files&&((l=s==null?void 0:s.files)==null?void 0:l.length)!==0&&e.jsx(K,{files:s.files}),(s==null?void 0:s.links)&&((c=s==null?void 0:s.links)==null?void 0:c.length)!==0&&e.jsx(X,{links:s.links}),e.jsx(Z,{post:s,collectionName:"posts"})]})}),Fe=()=>{const{setHeaderTitle:s}=r.useContext(I),[d,f]=r.useState([]);T();const x=$(U,"posts"),[a,t]=r.useState(!0),[g,h]=r.useState(!1),[u,y]=r.useState(null),[n,j]=r.useState(0),[l,c]=r.useState(null),[S,A]=r.useState(!0),w=6,[L,M]=r.useState(null);r.useEffect(()=>{s("STAR EDUCATION ACADEMY")},[]);const C=async()=>{t(!0);let o=b(x,z("time","desc"),V(w));L&&(o=b(o,F(L)));try{const i=await O(o);if(i.empty)h(!0);else{const p=i.docs.map(E=>({id:E.id,...E.data()}));f([...d,...p]),M(i.docs[i.docs.length-1]),G(t),j(n+1),p.length<w&&A(!1)}}catch(i){const p="Error fetching posts: "+i.message;console.log(p),t(!1),y(p)}};return r.useEffect(()=>{C()},[]),B("posts-page"),a&&n===0?e.jsx(q,{isLoading:a,text:"Loading posts..."}):g?e.jsx(v,{text:"No posts available"}):u?e.jsx(v,{text:u}):e.jsxs(m,{children:[e.jsx(oe,{}),e.jsxs("div",{className:"grid gap-y-6 m-2",children:[l&&e.jsx(J,{image:l,setViewingImage:c,postImage:!0}),d.sort((o,i)=>H(o,i,"time","newer")).map(o=>e.jsx(ae,{setViewingImage:c,post:o},o.id))]}),S?e.jsx("div",{className:"flex justify-center mt-1 mb-2 ",children:e.jsx(ie,{size:"small",onClick:C,children:"load more"})}):""]})};export{Fe as default};
