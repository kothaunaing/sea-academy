import{j as e,I as Y,r as a,A as Z,a as _,c as ee,b as y,aV as se,H as I,E as o,d as S,aJ as te,K as ae,S as ie,aP as re,W as oe,aC as ne,aR as ce,aF as le,ax as me,az as de,aA as ue,aw as T,ay as pe}from"./index-dSD7UM6z.js";import{i as xe}from"./browser-image-compression-9kymdGFS.js";import{c as he}from"./createSvgIcon-5tUNT3Hd.js";import{p as fe}from"./prettyDate-uNOGf4QX.js";import{f as ge}from"./fixTime-t8Fgsaat.js";import{S as n}from"./Skeleton-dIugF2Xi.js";import{T as r}from"./Typography-GbCp5BvV.js";import{B as L}from"./Button-ZTLNkO5Z.js";import{a as je,F as B}from"./FavoriteBorder-HxMcdhth.js";import{S as be}from"./Stack-4mDqqL4m.js";import{I as R}from"./IconButton-M8OEfqkq.js";import{C as $}from"./ContentCopySharp-l1_TNVEB.js";import{T as ve}from"./TextField-tugteksq.js";import{T as we}from"./Tooltip-pmR5sMk3.js";import{E as ye}from"./EditSharp-5MWA8YtH.js";import"./ButtonBase-D-lMm-wW.js";import"./Portal-nV2JPNiI.js";import"./Modal-40Myj6Vm.js";import"./debounce-gOEKrWSg.js";import"./useControlled-ajujHaEs.js";const Ie=he(e.jsx("path",{d:"M15 1H9v2h6zm-4 13h2V8h-2zm8.03-6.61 1.42-1.42c-.43-.51-.9-.99-1.41-1.41l-1.42 1.42C16.07 4.74 14.12 4 12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9 9-4.03 9-9c0-2.12-.74-4.07-1.97-5.61M12 20c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7"}),"TimerSharp"),Oe=Y.memo(()=>{const{userData:d,users:Se,setHeaderTitle:k,openSnackbar:l}=a.useContext(Z),[s,F]=a.useState(null),[U,C]=a.useState(!1),[p,h]=a.useState(!1),[f,D]=a.useState(null),[x,P]=a.useState(null),{userId:m}=_(),g=ee(S,`users/${m}/likes`),N=y(S,`/users/${m}`),[j,A]=a.useState(!1),[b,E]=a.useState(""),[z,W]=a.useState("offline"),[H,M]=a.useState(null);se(s==null?void 0:s.uid,W,M,[m,s]);const q=()=>te(N,i=>{i.exists()?(F({uid:i.id,...i.data()}),C(!1)):C(!0)});a.useEffect(()=>{const t=q();return()=>{t&&t()}},[m]);const c=()=>s&&d?d.uid===s.uid:!1,v=async()=>{await ae(g,D)};a.useEffect(()=>{const t=I.get("userId");(async()=>{const u=ie(g,re("uid","==",t)),w=await oe(u);h(!w.empty)})(),v()},[]);const J=async()=>{try{const t=I.get("userId"),i=y(g,d==null?void 0:d.uid),u={uid:t,timestamp:ne()};p?(h(!1),await le(i),v()):(h(!0),await ce(i,u),v())}catch(t){console.log(t.message)}};a.useEffect(()=>{s&&(c()?k("My Profile"):k(`${s.name}'s Profile`))},[s,m]);const O=async()=>{const t=I.get("userId"),i=y(S,`users/${t}`);if(!x)return;const u=`profile/${t}/${x.name}`,w=me(pe,u);l("Compressing image...");const G=await xe(x,{maxSizeMB:.5,maxWidthOrHeight:1280,useWebWorker:!0});l("Uploading image...");const Q=await de(w,G),X=await ue(Q.ref);await T(i,{coverImage:X}),l("Changed cover image successfully")},V=()=>{document.getElementById("imageInput").click()};a.useEffect(()=>{O()},[x]),a.useEffect(()=>{E(s==null?void 0:s.bio)},[s]);const K=async()=>{await T(N,{bio:b}),l("Edited bio successfully")};return U?e.jsx(o,{m:2,children:"User not available!"}):e.jsxs(o,{children:[e.jsx("input",{id:"imageInput",className:"hidden",type:"file",accept:"image/*",onChange:t=>P(t.target.files[0])}),e.jsxs(o,{className:"relative ",children:[s?e.jsx("img",{onClick:()=>{c()&&V()},className:`w-full h-[150px] object-cover ${c()?"cursor-pointer hover:opacity-80":""}`,src:s!=null&&s.coverImage?s==null?void 0:s.coverImage:"/images/education.jpg"}):e.jsx(n,{sx:{mt:-5},height:200,width:"100%"}),s?e.jsx("div",{className:"absolute -bottom-[40%] left-[10%]",children:e.jsxs("div",{className:"relative",children:[e.jsx("img",{alt:s.name,className:"rounded-full  size-24 object-cover border ",src:s.image}),e.jsx("div",{className:"size-[20px] bg-white rounded-full flex justify-center items-center absolute bottom-0 right-2",children:e.jsx("div",{className:` size-4 rounded-full ${z==="online"?"bg-green-500":"bg-gray-500"}`})})]})}):e.jsx("div",{className:"absolute z-10 bottom-0 left-[10%]",children:e.jsx(n,{variant:"circular",height:"96px",width:"96px"})})]}),e.jsxs(o,{m:2,mt:8,className:"",children:[s?e.jsxs(e.Fragment,{children:[e.jsxs(o,{className:"flex gap-x-3",children:[e.jsx(r,{variant:"h5",children:s.name}),e.jsx(L,{onClick:J,color:"error",size:"small",sx:{textTransform:"capitalize"},variant:p?"contained":"outlined",startIcon:p?e.jsx(B,{}):e.jsx(je,{}),children:p?"Liked":"Like"})]}),e.jsx(r,{sx:{mb:1,mt:-1},children:z==="online"?e.jsx(r,{variant:"caption",sx:{color:"green"},children:"Online"}):e.jsx(r,{variant:"caption",sx:{color:"gray"},children:H})}),c()&&e.jsx(be,{children:e.jsx(r,{variant:"caption",children:s.email})}),e.jsxs(o,{className:"flex gap-x-2 items-center mt-1",children:[e.jsxs(r,{variant:"caption",children:["UID: ",s.uid]}),e.jsx("div",{children:e.jsx(R,{onClick:()=>{navigator.clipboard.writeText(s.uid),l("UID copied successfully")},size:"small",children:e.jsx($,{fontSize:"18px"})})})]})]}):e.jsx(n,{sx:{marginTop:"-50px"},height:35,width:150}),s?e.jsxs("div",{className:"flex mt-2 mb-2 gap-x-2 items-center  border border-dashed rounded-md shadow-md border-slate-400 p-2 justify-between",children:[j?e.jsx(ve,{fullWidth:!0,name:"bio",size:"small",variant:"outlined",multiline:!0,maxRows:5,autoFocus:!0,value:b,onChange:t=>E(t.target.value),className:"pl-1 pr-1 w-auto font-bold text-sm",placeholder:"Enter description",inputProps:{sx:{fontSize:12}}}):e.jsx(e.Fragment,{children:s?e.jsx(r,{sx:{whiteSpace:"pre-line",width:"90%"},variant:"caption",className:"font-bold",children:s!=null&&s.bio?s.bio:c()?"Bio: I am a student":"No bio"}):e.jsx(n,{height:40,width:150})}),s&&c()?e.jsx(we,{title:"Edit bio",arrow:!0,children:e.jsx(R,{size:"small",onClick:()=>{A(!j),j&&b!==s.bio&&K()},className:" p-1  cursor-pointer",children:e.jsx(ye,{sx:{width:20,height:20}})})}):e.jsx(e.Fragment,{children:c()&&e.jsx(n,{variant:"circular",height:20,width:20})})]}):e.jsx(n,{height:40,width:250})]}),e.jsx(o,{m:2,className:"",children:s?e.jsxs(o,{className:"grid gap-y-2",children:[e.jsxs(r,{variant:"caption",children:[e.jsx(Ie,{})," Joined: ",fe(ge(s.createdAt))]}),f?e.jsxs(r,{variant:"caption",children:[e.jsx(B,{color:"error"})," ",f," ",f<=1?"person":"people"]}):"",e.jsx("div",{className:"flex justify-start mt-2",children:e.jsx(L,{onClick:()=>{const t=`${location.origin}/#/app/profile/${m}`;navigator.clipboard.writeText(t),l(`Copied ${s==null?void 0:s.name}'s profile link successfully!`)},startIcon:e.jsx($,{}),size:"small",children:"Copy link"})})]}):e.jsxs(e.Fragment,{children:[e.jsx(n,{height:35,width:150}),e.jsx(n,{height:35,width:150})]})})]})});export{Oe as default};
